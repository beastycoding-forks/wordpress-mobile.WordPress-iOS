# When using a Gem, Danger will always try and load the Gem's 'Dangerfile', without path
# When using Github, path: = path/to/Dangerfile, branch: "main"
# When using just a path: alone, it uses the given path/to/Dangerfile

danger.import_dangerfile(gem: 'danger-iantest')

# xcode_summary.report 'build/results/WordPress.xcresult'
junit.parse 'build/results/WordPress.xml'
# junit.report
all_test = junit.tests.map(&:attributes)
slowest_test = all_test.sort_by { |attributes| attributes[:time].to_f }.last

markdown '## Test Results'
markdown "#{slowest_test[:time]} took #{slowest_test[:time]} seconds"

message "Danger ID: `#{@env.danger_id}`"

if status_report[:errors].count.zero? && status_report[:warnings].count.zero?
  markdown("## :white_check_mark: No errors or warnings on post-build :thumbsup:")
end
